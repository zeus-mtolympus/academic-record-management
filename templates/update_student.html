{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h1>Update Student</h1>
    <form method="POST" action="{{ url_for('update_student') }}">
        <input type="hidden" name="institute_id" value="{{ student.institute_id }}">
        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="institute_id" class="form-label">Institute ID</label>
                    <input type="text" class="form-control" id="institute_id" value="{{ student.institute_id }}" readonly>
                </div>
                <div class="mb-3">
                    <label for="roll_no" class="form-label">Roll No</label>
                    <input type="text" class="form-control" id="roll_no" name="roll_no" value="{{ student.roll_no }}" required>
                </div>
                <div class="mb-3">
                    <label for="fname" class="form-label">First Name</label>
                    <input type="text" class="form-control" id="fname" name="fname" value="{{ student.fname }}" required>
                </div>
                <div class="mb-3">
                    <label for="lname" class="form-label">Last Name</label>
                    <input type="text" class="form-control" id="lname" name="lname" value="{{ student.lname }}" required>
                </div>
                <div class="mb-3">
                    <label for="dob" class="form-label">Date of Birth (YYYY-MM-DD)</label>
                    <input type="date" class="form-control" id="dob" name="dob" value="{{ student.dob }}">
                </div>
                <div class="mb-3">
                    <label for="gender" class="form-label">Gender</label>
                    <select class="form-select" id="gender" name="gender">
                        <option value="">Select</option>
                        <option value="Male" {% if student.gender == 'Male' %}selected{% endif %}>Male</option>
                        <option value="Female" {% if student.gender == 'Female' %}selected{% endif %}>Female</option>
                        <option value="Other" {% if student.gender == 'Other' %}selected{% endif %}>Other</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="status" class="form-label">Status</label>
                    <select class="form-select" id="status" name="status" required>
                        <option value="Active" {% if student.status == 'Active' %}selected{% endif %}>Active</option>
                        <option value="Studying" {% if student.status == 'Studying' %}selected{% endif %}>Studying</option>
                        <option value="Graduated" {% if student.status == 'Graduated' %}selected{% endif %}>Graduated</option>
                    </select>
                </div>
            </div>
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="department_id" class="form-label">Department</label>
                    <select class="form-select" id="department_id" name="department_id" required>
                        <option value="">Select Department</option>
                        {% for dept in departments %}
                        <option value="{{ dept.department_id }}" {% if student.department_id == dept.department_id %}selected{% endif %}>{{ dept.department_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-3">
                    <label for="batch" class="form-label">Batch</label>
                    <input type="text" class="form-control" id="batch" name="batch" value="{{ student.batch }}" required>
                </div>
                <div class="mb-3">
                    <label for="house_no" class="form-label">House No</label>
                    <input type="text" class="form-control" id="house_no" name="house_no" value="{{ student.house_no }}">
                </div>
                <div class="mb-3">
                    <label for="lane" class="form-label">Lane</label>
                    <input type="text" class="form-control" id="lane" name="lane" value="{{ student.lane }}">
                </div>
                <div class="mb-3">
                    <label for="city" class="form-label">City</label>
                    <input type="text" class="form-control" id="city" name="city" value="{{ student.city }}">
                </div>
                <div class="mb-3">
                    <label for="state" class="form-label">State</label>
                    <input type="text" class="form-control" id="state" name="state" value="{{ student.state }}">
                </div>
                <div class="mb-3">
                    <label for="country" class="form-label">Country</label>
                    <input type="text" class="form-control" id="country" name="country" value="{{ student.country }}">
                </div>
                <div class="mb-3">
                    <label for="pincode" class="form-label">Pincode</label>
                    <input type="text" class="form-control" id="pincode" name="pincode" value="{{ student.pincode }}">
                </div>
            </div>
        </div>
        
        <!-- Add New Guardian Section (optional) -->
        <h3 class="mt-4">Add New Guardian (Optional)</h3>
        <div class="row">
            <div class="col-12">
                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="add_guardian" name="add_guardian" value="yes">
                    <label class="form-check-label" for="add_guardian">
                        Add a new guardian
                    </label>
                </div>
            </div>
        </div>
        <div id="guardian_section" style="display: none;">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="guardian_name" class="form-label">Guardian Name</label>
                        <input type="text" class="form-control" id="guardian_name" name="guardian_name">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_gender" class="form-label">Guardian Gender</label>
                        <select class="form-select" id="guardian_gender" name="guardian_gender">
                            <option value="">Select</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="guardian_relation" class="form-label">Relation</label>
                        <input type="text" class="form-control" id="guardian_relation" name="guardian_relation" placeholder="e.g., Father">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="guardian_email" name="guardian_email">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_phone" class="form-label">Phone</label>
                        <input type="text" class="form-control" id="guardian_phone" name="guardian_phone">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="guardian_occupation" class="form-label">Occupation</label>
                        <input type="text" class="form-control" id="guardian_occupation" name="guardian_occupation">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_house_no" class="form-label">House No</label>
                        <input type="text" class="form-control" id="guardian_house_no" name="guardian_house_no">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_lane" class="form-label">Lane</label>
                        <input type="text" class="form-control" id="guardian_lane" name="guardian_lane">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_city" class="form-label">City</label>
                        <input type="text" class="form-control" id="guardian_city" name="guardian_city">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_state" class="form-label">State</label>
                        <input type="text" class="form-control" id="guardian_state" name="guardian_state">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_country" class="form-label">Country</label>
                        <input type="text" class="form-control" id="guardian_country" name="guardian_country">
                    </div>
                    <div class="mb-3">
                        <label for="guardian_pincode" class="form-label">Pincode</label>
                        <input type="text" class="form-control" id="guardian_pincode" name="guardian_pincode">
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            document.getElementById('add_guardian').addEventListener('change', function() {
                document.getElementById('guardian_section').style.display = this.checked ? 'block' : 'none';
            });
        </script>
        
        <button type="submit" class="btn btn-warning">Update Student</button>
        <a href="{{ url_for('manage_users') }}" class="btn btn-secondary">Back</a>
    </form>
</div>
{% endblock %}